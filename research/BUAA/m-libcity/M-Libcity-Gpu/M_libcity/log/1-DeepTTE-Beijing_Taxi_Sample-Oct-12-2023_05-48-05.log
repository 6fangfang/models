2023-10-12 05:48:05,568 - INFO - Log directory: /home/zhangwt/remote/M-Libcity/M_libcity/log
2023-10-12 05:48:05,568 - INFO - Begin pipeline, task=eta, model_name=DeepTTE, dataset_name=Beijing_Taxi_Sample, exp_id=1
2023-10-12 05:48:05,568 - INFO - {'task': 'eta', 'model': 'DeepTTE', 'dataset': 'Beijing_Taxi_Sample', 'saved_model': True, 'train': False, 'batch_size': 64, 'exp_id': 1, 'dataset_class': 'ETADataset', 'eta_encoder': 'DeeptteEncoder', 'executor': 'ETAExecutor', 'evaluator': 'ETAEvaluator', 'uid_emb_size': 16, 'weekid_emb_size': 3, 'timdid_emb_size': 8, 'kernel_size': 3, 'num_filter': 32, 'pooling_method': 'attention', 'num_final_fcs': 4, 'final_fc_size': 128, 'alpha': 0.1, 'rnn_type': 'LSTM', 'rnn_num_layers': 1, 'hidden_size': 128, 'max_epoch': 100, 'learner': 'adam', 'learning_rate': 0.001, 'lr_decay': False, 'clip_grad_norm': False, 'use_early_stop': False, 'patience': 20, 'num_workers': 1, 'min_session_len': 5, 'max_session_len': 50, 'min_sessions': 0, 'window_size': 1, 'cut_method': 'time_interval', 'pad_with_last_sample': True, 'sort_by_traj_len': True, 'cache_dataset': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'max_grad_norm': 1.0, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'metrics': ['MAE', 'RMSE'], 'mode': 'single', 'save_modes': ['csv'], 'geo': {'including_types': ['Polygon'], 'Polygon': {'coordinates': 'coordinate', 'embedding': 'other'}}, 'usr': {'properties': {}}, 'dyna': {'including_types': ['trajectory'], 'trajectory': {'entity_id': 'usr_id', 'traj_id': 'num', 'coordinates': 'coordinate', 'current_dis': 'num', 'speeds': 'other', 'speeds_relevant1': 'other', 'speeds_relevant2': 'other', 'speeds_long': 'other', 'grid_len': 'num', 'holiday': 'num'}}, 'geo_file': 'Beijing_Taxi_Sample', 'usr_file': 'Beijing_Taxi_Sample', 'dyna_file': 'Beijing_Taxi_Sample'}
2023-10-12 05:48:06,420 - INFO - Loading file /home/zhangwt/remote/M-Libcity/M_libcity/cache/dataset_cache/eta_Beijing_Taxi_Sample_DeeptteEncoder.json
2023-10-12 05:48:06,766 - INFO - longi_mean: 116.38167145561566
2023-10-12 05:48:06,766 - INFO - longi_std: 0.07416283805701834
2023-10-12 05:48:06,766 - INFO - lati_mean: 39.92553892677388
2023-10-12 05:48:06,766 - INFO - lati_std: 0.049981772271572
2023-10-12 05:48:06,766 - INFO - dist_mean: 8.814695989840317
2023-10-12 05:48:06,766 - INFO - dist_std: 7.073727325486173
2023-10-12 05:48:06,766 - INFO - time_mean: 1166.8956065318819
2023-10-12 05:48:06,766 - INFO - time_std: 973.9645727168944
2023-10-12 05:48:06,766 - INFO - dist_gap_mean: 0.3897806752549975
2023-10-12 05:48:06,766 - INFO - dist_gap_std: 0.22667483085183782
2023-10-12 05:48:06,767 - INFO - time_gap_mean: 51.59943780140807
2023-10-12 05:48:06,767 - INFO - time_gap_std: 44.83032982709822
2023-10-12 05:48:06,801 - INFO - Number of train data: 15432
2023-10-12 05:48:06,801 - INFO - Number of eval  data: 2200
2023-10-12 05:48:06,801 - INFO - Number of test  data: 4368
2023-10-12 05:48:07,424 - INFO - DeepTTE<
  (network): DeepTTE_model<
    (attr_net): Attr<
      (uid_em): Embedding<vocab_size=4968, embedding_size=16, use_one_hot=False, embedding_table=Parameter (name=network.attr_net.uid_em.embedding_table, shape=(4968, 16), dtype=Float32, requires_grad=True), dtype=Float32, padding_idx=None>
      (weekid_em): Embedding<vocab_size=7, embedding_size=3, use_one_hot=False, embedding_table=Parameter (name=network.attr_net.weekid_em.embedding_table, shape=(7, 3), dtype=Float32, requires_grad=True), dtype=Float32, padding_idx=None>
      (timeid_em): Embedding<vocab_size=1440, embedding_size=8, use_one_hot=False, embedding_table=Parameter (name=network.attr_net.timeid_em.embedding_table, shape=(1440, 8), dtype=Float32, requires_grad=True), dtype=Float32, padding_idx=None>
      >
    (spatio_temporal): SpatioTemporal<
      (geo_conv): GeoConv<
        (state_em): Embedding<vocab_size=2, embedding_size=2, use_one_hot=False, embedding_table=Parameter (name=network.spatio_temporal.geo_conv.state_em.embedding_table, shape=(2, 2), dtype=Float32, requires_grad=True), dtype=Float32, padding_idx=None>
        (process_coords): Dense<input_channels=4, output_channels=16, has_bias=True>
        (conv): Conv1d<input_channels=16, output_channels=32, kernel_size=(1, 3), stride=(1, 1), pad_mode=pad, padding=(0, 0, 0, 0), dilation=(1, 1), group=1, has_bias=False, weight_init=normal, bias_init=zeros, format=NCHW>
        >
      (rnn): LSTM<
        (rnn): _DynamicLSTMCPUGPU<>
        (dropout_op): Dropout<p=0.0>
        >
      (attr2atten): Dense<input_channels=28, output_channels=128, has_bias=True>
      >
    (entire_estimate): EntireEstimator<
      (input2hid): Dense<input_channels=156, output_channels=128, has_bias=True>
      (residuals): CellList<
        (0): Dense<input_channels=128, output_channels=128, has_bias=True>
        (1): Dense<input_channels=128, output_channels=128, has_bias=True>
        (2): Dense<input_channels=128, output_channels=128, has_bias=True>
        (3): Dense<input_channels=128, output_channels=128, has_bias=True>
        >
      (hid2out): Dense<input_channels=128, output_channels=1, has_bias=True>
      >
    (local_estimate): LocalEstimator<
      (input2hid): Dense<input_channels=128, output_channels=64, has_bias=True>
      (hid2hid): Dense<input_channels=64, output_channels=32, has_bias=True>
      (hid2out): Dense<input_channels=32, output_channels=1, has_bias=True>
      >
    >
  >
2023-10-12 05:48:07,425 - INFO - network.attr_net.uid_em.embedding_table	(4968, 16)	True
2023-10-12 05:48:07,425 - INFO - network.attr_net.weekid_em.embedding_table	(7, 3)	True
2023-10-12 05:48:07,425 - INFO - network.attr_net.timeid_em.embedding_table	(1440, 8)	True
2023-10-12 05:48:07,425 - INFO - network.spatio_temporal.geo_conv.state_em.embedding_table	(2, 2)	True
2023-10-12 05:48:07,425 - INFO - network.spatio_temporal.geo_conv.process_coords.weight	(16, 4)	True
2023-10-12 05:48:07,425 - INFO - network.spatio_temporal.geo_conv.process_coords.bias	(16,)	True
2023-10-12 05:48:07,425 - INFO - network.spatio_temporal.geo_conv.conv.weight	(32, 16, 1, 3)	True
2023-10-12 05:48:07,425 - INFO - network.spatio_temporal.rnn.weight_ih_l0	(512, 61)	True
2023-10-12 05:48:07,425 - INFO - network.spatio_temporal.rnn.weight_hh_l0	(512, 128)	True
2023-10-12 05:48:07,425 - INFO - network.spatio_temporal.rnn.bias_ih_l0	(512,)	True
2023-10-12 05:48:07,426 - INFO - network.spatio_temporal.rnn.bias_hh_l0	(512,)	True
2023-10-12 05:48:07,426 - INFO - network.spatio_temporal.attr2atten.weight	(128, 28)	True
2023-10-12 05:48:07,426 - INFO - network.spatio_temporal.attr2atten.bias	(128,)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.input2hid.weight	(128, 156)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.input2hid.bias	(128,)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.residuals.0.weight	(128, 128)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.residuals.0.bias	(128,)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.residuals.1.weight	(128, 128)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.residuals.1.bias	(128,)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.residuals.2.weight	(128, 128)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.residuals.2.bias	(128,)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.residuals.3.weight	(128, 128)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.residuals.3.bias	(128,)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.hid2out.weight	(1, 128)	True
2023-10-12 05:48:07,426 - INFO - network.entire_estimate.hid2out.bias	(1,)	True
2023-10-12 05:48:07,426 - INFO - network.local_estimate.input2hid.weight	(64, 128)	True
2023-10-12 05:48:07,426 - INFO - network.local_estimate.input2hid.bias	(64,)	True
2023-10-12 05:48:07,426 - INFO - network.local_estimate.hid2hid.weight	(32, 64)	True
2023-10-12 05:48:07,426 - INFO - network.local_estimate.hid2hid.bias	(32,)	True
2023-10-12 05:48:07,426 - INFO - network.local_estimate.hid2out.weight	(1, 32)	True
2023-10-12 05:48:07,426 - INFO - network.local_estimate.hid2out.bias	(1,)	True
2023-10-12 05:48:07,427 - INFO - Total parameter numbers: 290795
2023-10-12 05:48:07,427 - INFO - You select `adam` optimizer.
2023-10-12 05:48:07,463 - WARNING - Received none train loss func and will use the loss func defined in the model.
2023-10-12 05:48:07,465 - INFO - Loaded model at /home/zhangwt/remote/M-Libcity/M_libcity/cache/1/model_cache/DeepTTE_Beijing_Taxi_Sample.ckpt
2023-10-12 05:48:07,526 - INFO - Start evaluating ...
2023-10-12 05:48:27,297 - INFO - Evaluate result is saved at /home/zhangwt/remote/M-Libcity/M_libcity/cache/1/evaluate_cache/2023_10_12_05_48_27_DeepTTE_Beijing_Taxi_Sample.csv
2023-10-12 05:48:27,302 - INFO - 
         MAE       RMSE
1  214.45218  333.43512
