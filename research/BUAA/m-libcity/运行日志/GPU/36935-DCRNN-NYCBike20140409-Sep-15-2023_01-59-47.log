2023-09-15 01:59:47,796 - INFO - Log directory: /home/zhangwt/remote/M-Libcity/M_libcity/log
2023-09-15 01:59:47,796 - INFO - Begin pipeline, task=traffic_state_pred, model_name=DCRNN, dataset_name=NYCBike20140409, exp_id=36935
2023-09-15 01:59:47,796 - INFO - {'task': 'traffic_state_pred', 'model': 'DCRNN', 'dataset': 'NYCBike20140409', 'saved_model': True, 'train': True, 'batch_size': 128, 'dataset_class': 'TrafficStateGridDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'cl_decay_steps': 2000, 'filter_type': 'dual_random_walk', 'bidir_adj_mx': False, 'max_diffusion_step': 2, 'num_rnn_layers': 2, 'rnn_units': 32, 'use_curriculum_learning': True, 'scaler': 'standard', 'load_external': True, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': True, 'add_day_in_week': False, 'max_epoch': 100, 'learner': 'adam', 'learning_rate': 0.01, 'lr_decay': True, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_early_stop': True, 'patience': 50, 'cache_dataset': True, 'num_workers': 1, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'output_window': 12, 'use_row_column': False, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0.0, 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'metrics': ['MAE', 'MAPE', 'MSE', 'RMSE'], 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Polygon'], 'Polygon': {'row_id': 'num', 'column_id': 'num'}}, 'grid': {'including_types': ['state'], 'state': {'row_id': 16, 'column_id': 8, 'new_flow': 'num', 'end_flow': 'num'}}, 'data_col': ['new_flow', 'end_flow'], 'data_files': ['NYCBIKE20140409'], 'geo_file': 'NYCBIKE20140409', 'output_dim': 2, 'time_intervals': 3600, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': False, 'weight_adj_epsilon': 0.1, 'exp_id': 36935}
2023-09-15 01:59:47,817 - INFO - Loaded file NYCBIKE20140409.geo, num_grids=128, grid_size=(16, 8)
2023-09-15 01:59:47,819 - INFO - Generate grid rel file, shape=(128, 128)
2023-09-15 01:59:47,819 - INFO - Loading /home/zhangwt/remote/M-Libcity/M_libcity/cache/dataset_cache/grid_based_NYCBike20140409_12_12_0.7_0.1_standard_128_True_True_False_True_False.npz
2023-09-15 01:59:48,560 - INFO - train	x: (3058, 12, 128, 3), y: (3058, 12, 128, 3)
2023-09-15 01:59:48,560 - INFO - eval	x: (437, 12, 128, 3), y: (437, 12, 128, 3)
2023-09-15 01:59:48,560 - INFO - test	x: (874, 12, 128, 3), y: (874, 12, 128, 3)
2023-09-15 01:59:48,704 - INFO - StandardScaler mean: 9.230346759524199, std: 18.07876831474537
2023-09-15 01:59:48,704 - INFO - NoneScaler
2023-09-15 01:59:53,346 - INFO - DCRNN<
  (network): DCRNNModel<
    (encoder_model): EncoderModel<
      (dcgru_layers): CellList<
        (0): DCGRUCell<>
        (1): DCGRUCell<>
        >
      >
    (decoder_model): DecoderModel<
      (projection_layer): Dense<input_channels=32, output_channels=1, has_bias=True>
      (dcgru_layers): CellList<
        (0): DCGRUCell<>
        (1): DCGRUCell<>
        >
      >
    >
  >
2023-09-15 01:59:53,347 - INFO - gconv_weight_(170, 64)_1	(170, 64)	True
2023-09-15 01:59:53,347 - INFO - gconv_biases_64_1	(64,)	True
2023-09-15 01:59:53,347 - INFO - gconv_weight_(170, 32)_2	(170, 32)	True
2023-09-15 01:59:53,347 - INFO - gconv_biases_32_2	(32,)	True
2023-09-15 01:59:53,347 - INFO - gconv_weight_(320, 64)_3	(320, 64)	True
2023-09-15 01:59:53,347 - INFO - gconv_biases_64_3	(64,)	True
2023-09-15 01:59:53,347 - INFO - gconv_weight_(320, 32)_4	(320, 32)	True
2023-09-15 01:59:53,347 - INFO - gconv_biases_32_4	(32,)	True
2023-09-15 01:59:53,347 - INFO - network.decoder_model.projection_layer.weight	(1, 32)	True
2023-09-15 01:59:53,347 - INFO - network.decoder_model.projection_layer.bias	(1,)	True
2023-09-15 01:59:53,347 - INFO - gconv_weight_(165, 64)_5	(165, 64)	True
2023-09-15 01:59:53,347 - INFO - gconv_biases_64_5	(64,)	True
2023-09-15 01:59:53,347 - INFO - gconv_weight_(165, 32)_6	(165, 32)	True
2023-09-15 01:59:53,347 - INFO - gconv_biases_32_6	(32,)	True
2023-09-15 01:59:53,348 - INFO - gconv_weight_(320, 64)_7	(320, 64)	True
2023-09-15 01:59:53,348 - INFO - gconv_biases_64_7	(64,)	True
2023-09-15 01:59:53,348 - INFO - gconv_weight_(320, 32)_8	(320, 32)	True
2023-09-15 01:59:53,348 - INFO - gconv_biases_32_8	(32,)	True
2023-09-15 01:59:53,348 - INFO - Total parameter numbers: 94017
2023-09-15 01:59:53,348 - INFO - You select `multisteplr` lr_scheduler.
2023-09-15 01:59:53,350 - INFO - You select `adam` optimizer.
2023-09-15 01:59:53,378 - WARNING - Received none train loss func and will use the loss func defined in the model.
2023-09-15 01:59:53,378 - INFO - Start training ...
2023-09-15 01:59:53,378 - INFO - num_batches:54
2023-09-15 02:01:27,629 - INFO - valid loss 为: 6.647764682769775
2023-09-15 02:02:59,212 - INFO - valid loss 为: 5.568439483642578
2023-09-15 02:04:29,582 - INFO - valid loss 为: 5.208272933959961
2023-09-15 02:05:59,859 - INFO - valid loss 为: 4.989569187164307
2023-09-15 02:07:29,682 - INFO - valid loss 为: 4.878443241119385
2023-09-15 02:08:59,605 - INFO - valid loss 为: 4.746758937835693
2023-09-15 02:10:33,127 - INFO - valid loss 为: 4.70258092880249
2023-09-15 02:12:03,820 - INFO - valid loss 为: 4.674177169799805
2023-09-15 02:13:35,272 - INFO - valid loss 为: 4.652627468109131
2023-09-15 02:15:05,998 - INFO - valid loss 为: 4.530717372894287
2023-09-15 02:16:37,296 - INFO - valid loss 为: 4.639950275421143
2023-09-15 02:18:08,672 - INFO - valid loss 为: 4.853801250457764
2023-09-15 02:19:40,846 - INFO - valid loss 为: 4.681873798370361
2023-09-15 02:21:11,821 - INFO - valid loss 为: 4.715889930725098
2023-09-15 02:22:42,124 - INFO - valid loss 为: 4.621062755584717
2023-09-15 02:24:14,753 - INFO - valid loss 为: 5.169042110443115
2023-09-15 02:25:47,179 - INFO - valid loss 为: 5.090686321258545
2023-09-15 02:27:18,475 - INFO - valid loss 为: 6.0396857261657715
2023-09-15 02:28:51,002 - INFO - valid loss 为: 5.473914623260498
2023-09-15 02:30:22,165 - INFO - valid loss 为: 6.366613388061523
2023-09-15 02:31:52,609 - INFO - valid loss 为: 5.8776116371154785
2023-09-15 02:33:23,402 - INFO - valid loss 为: 5.722952365875244
2023-09-15 02:34:54,857 - INFO - valid loss 为: 5.534303665161133
2023-09-15 02:36:25,721 - INFO - valid loss 为: 5.550891399383545
2023-09-15 02:37:56,411 - INFO - valid loss 为: 5.762674808502197
2023-09-15 02:39:27,442 - INFO - valid loss 为: 5.502983570098877
2023-09-15 02:40:57,096 - INFO - valid loss 为: 5.357508182525635
2023-09-15 02:42:26,944 - INFO - valid loss 为: 5.3848347663879395
2023-09-15 02:43:58,044 - INFO - valid loss 为: 5.3675103187561035
2023-09-15 02:45:29,680 - INFO - valid loss 为: 5.3622965812683105
2023-09-15 02:47:00,521 - INFO - valid loss 为: 5.289357662200928
2023-09-15 02:48:31,425 - INFO - valid loss 为: 5.216452121734619
2023-09-15 02:50:03,028 - INFO - valid loss 为: 5.247481346130371
2023-09-15 02:51:34,096 - INFO - valid loss 为: 5.310550212860107
2023-09-15 02:53:05,855 - INFO - valid loss 为: 5.2088775634765625
2023-09-15 02:54:37,590 - INFO - valid loss 为: 5.020761013031006
2023-09-15 02:56:08,984 - INFO - valid loss 为: 5.159332275390625
2023-09-15 02:57:41,176 - INFO - valid loss 为: 4.938793659210205
2023-09-15 02:59:11,766 - INFO - valid loss 为: 5.118648052215576
2023-09-15 03:00:43,880 - INFO - valid loss 为: 4.999472141265869
2023-09-15 03:02:14,467 - INFO - valid loss 为: 5.122537136077881
2023-09-15 03:03:44,769 - INFO - valid loss 为: 5.067142009735107
2023-09-15 03:05:16,335 - INFO - valid loss 为: 4.940174579620361
2023-09-15 03:06:46,401 - INFO - valid loss 为: 5.075505256652832
2023-09-15 03:08:17,736 - INFO - valid loss 为: 5.165567874908447
2023-09-15 03:09:48,116 - INFO - valid loss 为: 4.941401481628418
2023-09-15 03:11:19,832 - INFO - valid loss 为: 5.005899906158447
2023-09-15 03:12:50,967 - INFO - valid loss 为: 5.068883895874023
2023-09-15 03:14:22,907 - INFO - valid loss 为: 5.074107646942139
2023-09-15 03:15:53,841 - INFO - valid loss 为: 4.934505462646484
2023-09-15 03:17:24,854 - INFO - valid loss 为: 4.838018417358398
2023-09-15 03:18:56,790 - INFO - valid loss 为: 4.864246368408203
2023-09-15 03:20:28,336 - INFO - valid loss 为: 4.8369526863098145
2023-09-15 03:22:00,146 - INFO - valid loss 为: 4.854107856750488
2023-09-15 03:23:32,562 - INFO - valid loss 为: 5.008294105529785
2023-09-15 03:25:04,177 - INFO - valid loss 为: 5.1631951332092285
2023-09-15 03:26:35,477 - INFO - valid loss 为: 5.0415215492248535
2023-09-15 03:28:06,490 - INFO - valid loss 为: 5.013316631317139
2023-09-15 03:29:37,991 - INFO - valid loss 为: 4.8487229347229
2023-09-15 03:31:08,886 - INFO - valid loss 为: 4.761051654815674
2023-09-15 03:32:41,651 - INFO - valid loss 为: 4.933322429656982
2023-09-15 03:34:13,306 - INFO - valid loss 为: 4.725406169891357
2023-09-15 03:35:45,124 - INFO - valid loss 为: 4.8225507736206055
2023-09-15 03:37:15,313 - INFO - valid loss 为: 4.7297043800354
2023-09-15 03:38:46,920 - INFO - valid loss 为: 4.777132511138916
2023-09-15 03:40:17,965 - INFO - valid loss 为: 4.7706427574157715
2023-09-15 03:41:49,270 - INFO - valid loss 为: 4.999465465545654
2023-09-15 03:43:21,568 - INFO - valid loss 为: 4.729506015777588
2023-09-15 03:44:53,519 - INFO - valid loss 为: 4.7066969871521
2023-09-15 03:46:24,300 - INFO - valid loss 为: 4.776895523071289
2023-09-15 03:47:55,656 - INFO - valid loss 为: 4.962538242340088
2023-09-15 03:49:26,847 - INFO - valid loss 为: 4.944684982299805
2023-09-15 03:50:57,736 - INFO - valid loss 为: 4.706236362457275
2023-09-15 03:52:29,347 - INFO - valid loss 为: 4.817823886871338
2023-09-15 03:54:02,511 - INFO - valid loss 为: 4.676015377044678
2023-09-15 03:55:34,378 - INFO - valid loss 为: 4.90726900100708
2023-09-15 03:57:06,440 - INFO - valid loss 为: 5.03364372253418
2023-09-15 03:58:37,671 - INFO - valid loss 为: 4.734231948852539
2023-09-15 04:00:09,720 - INFO - valid loss 为: 4.661534786224365
2023-09-15 04:01:41,559 - INFO - valid loss 为: 4.678402423858643
2023-09-15 04:03:12,083 - INFO - valid loss 为: 4.7139692306518555
2023-09-15 04:04:43,205 - INFO - valid loss 为: 4.6681809425354
2023-09-15 04:06:15,834 - INFO - valid loss 为: 4.8172430992126465
2023-09-15 04:07:47,211 - INFO - valid loss 为: 4.915242671966553
2023-09-15 04:09:19,585 - INFO - valid loss 为: 4.694520950317383
2023-09-15 04:10:51,390 - INFO - valid loss 为: 4.681003093719482
2023-09-15 04:12:24,134 - INFO - valid loss 为: 4.859067916870117
2023-09-15 04:13:55,282 - INFO - valid loss 为: 4.661576747894287
2023-09-15 04:15:26,692 - INFO - valid loss 为: 4.710320949554443
2023-09-15 04:16:57,514 - INFO - valid loss 为: 4.95375394821167
2023-09-15 04:18:28,759 - INFO - valid loss 为: 4.680517673492432
2023-09-15 04:20:00,992 - INFO - valid loss 为: 4.641452312469482
2023-09-15 04:21:31,719 - INFO - valid loss 为: 4.6603827476501465
2023-09-15 04:23:02,742 - INFO - valid loss 为: 4.629788875579834
2023-09-15 04:24:34,690 - INFO - valid loss 为: 4.738440990447998
2023-09-15 04:26:05,797 - INFO - valid loss 为: 4.794779300689697
2023-09-15 04:27:36,550 - INFO - valid loss 为: 4.889599800109863
2023-09-15 04:29:08,958 - INFO - valid loss 为: 4.660175800323486
2023-09-15 04:30:40,944 - INFO - valid loss 为: 4.736843109130859
2023-09-15 04:32:10,793 - INFO - valid loss 为: 4.643990993499756
2023-09-15 04:32:11,184 - INFO - Loaded model at /home/zhangwt/remote/M-Libcity/M_libcity/cache/36935/model_cache/DCRNN_NYCBike20140409.ckpt
2023-09-15 04:32:11,214 - INFO - Start evaluating ...
2023-09-15 04:32:19,838 - INFO - Note that you select the single mode to evaluate!
2023-09-15 04:32:19,875 - INFO - Evaluate result is saved at /home/zhangwt/remote/M-Libcity/M_libcity/cache/36935/evaluate_cache/2023_09_15_04_32_19_DCRNN_NYCBike20140409.csv
2023-09-15 04:32:19,887 - INFO - 
          MAE        MAPE       RMSE
1    3.159159  0.25902787  5.8821707
