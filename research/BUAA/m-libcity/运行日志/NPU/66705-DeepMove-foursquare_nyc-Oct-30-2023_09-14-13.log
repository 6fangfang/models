2023-10-30 09:14:13,510 - INFO - Log directory: /home/mindspore/yxx/m-libcity/M_libcity/log
2023-10-30 09:14:13,510 - INFO - Begin pipeline, task=traj_loc_pred, model_name=DeepMove, dataset_name=foursquare_nyc, exp_id=66705
2023-10-30 09:14:13,510 - INFO - {'task': 'traj_loc_pred', 'model': 'DeepMove', 'dataset': 'foursquare_nyc', 'saved_model': True, 'train': True, 'batch_size': 64, 'max_epoch': 30, 'dataset_class': 'TrajectoryDataset', 'traj_encoder': 'StandardTrajectoryEncoder', 'executor': 'TrajLocPredExecutor', 'evaluator': 'TrajLocPredEvaluator', 'loc_emb_size': 300, 'uid_emb_size': 16, 'tim_emb_size': 16, 'hidden_size': 300, 'attn_type': 'dot', 'rnn_type': 'LSTM', 'dropout_p': 0.2, 'learning_rate': 0.001, 'lr_step': 3, 'optimizer': 'adam', 'window_size': 72, 'max_session_len': 50, 'min_session_len': 5, 'min_sessions': 5, 'min_checkins': 5, 'num_workers': 1, 'cache_dataset': True, 'train_rate': 0.8, 'eval_rate': 0.1, 'history_type': 'splice', 'cut_method': 'time_interval', 'gpu': True, 'gpu_id': 0, 'L2': 1e-05, 'lr_decay': 0.1, 'clip': 1.0, 'schedule_threshold': 0.001, 'loss_func': 'default', 'load_best_epoch': True, 'hyper_tune': False, 'early_stop_lr': 9e-06, 'debug': False, 'metrics': ['Precision', 'Recall'], 'evaluate_method': 'popularity', 'topk': 1, 'geo': {'including_types': ['Point'], 'Point': {'venue_category_name': 'enum'}}, 'usr': {'properties': {'gender': 'enum', 'twitter_friend_count': 'num', 'twitter_follower_count': 'num'}}, 'dyna': {'including_types': ['trajectory'], 'trajectory': {'entity_id': 'usr_id', 'location': 'geo_id', 'timezone_offset_in_minutes': 'num'}}, 'distance_upper': 30.0, 'geo_file': 'foursquare_nyc', 'dyna_file': 'foursquare_nyc', 'usr_file': 'foursquare_nyc', 'exp_id': 66705}
2023-10-30 09:14:40,061 - INFO - You select `adam` optimizer.
2023-10-30 09:14:40,173 - INFO - Start training ...
2023-10-30 09:14:40,174 - INFO - num_batches:1367
2023-10-30 09:39:35,587 - INFO - Epoch: [  1/ 30], Average Train Loss: [7.030], Accuracy: [0.125]
2023-10-30 09:39:35,587 - INFO - save model in/home/mindspore/yxx/m-libcity/M_libcity/cache/66705/model_cache/DeepMove_foursquare_nyc.ckpt
2023-10-30 10:03:52,584 - INFO - Epoch: [  2/ 30], Average Train Loss: [5.010], Accuracy: [0.161]
2023-10-30 10:03:52,585 - INFO - save model in/home/mindspore/yxx/m-libcity/M_libcity/cache/66705/model_cache/DeepMove_foursquare_nyc.ckpt
2023-10-30 10:28:09,707 - INFO - Epoch: [  3/ 30], Average Train Loss: [4.254], Accuracy: [0.165]
2023-10-30 10:28:09,707 - INFO - save model in/home/mindspore/yxx/m-libcity/M_libcity/cache/66705/model_cache/DeepMove_foursquare_nyc.ckpt
2023-10-30 10:52:27,586 - INFO - Epoch: [  4/ 30], Average Train Loss: [3.870], Accuracy: [0.173]
2023-10-30 10:52:27,587 - INFO - save model in/home/mindspore/yxx/m-libcity/M_libcity/cache/66705/model_cache/DeepMove_foursquare_nyc.ckpt
2023-10-30 11:16:44,582 - INFO - Epoch: [  5/ 30], Average Train Loss: [3.600], Accuracy: [0.178]
2023-10-30 11:16:44,582 - INFO - save model in/home/mindspore/yxx/m-libcity/M_libcity/cache/66705/model_cache/DeepMove_foursquare_nyc.ckpt
2023-10-30 11:41:01,247 - INFO - Epoch: [  6/ 30], Average Train Loss: [3.341], Accuracy: [0.177]
2023-10-30 12:05:18,735 - INFO - Epoch: [  7/ 30], Average Train Loss: [3.154], Accuracy: [0.182]
2023-10-30 12:05:18,735 - INFO - save model in/home/mindspore/yxx/m-libcity/M_libcity/cache/66705/model_cache/DeepMove_foursquare_nyc.ckpt
2023-10-30 12:29:36,188 - INFO - Epoch: [  8/ 30], Average Train Loss: [2.901], Accuracy: [0.178]
2023-10-30 12:53:52,791 - INFO - Epoch: [  9/ 30], Average Train Loss: [2.675], Accuracy: [0.177]
2023-10-30 13:18:10,877 - INFO - Epoch: [ 10/ 30], Average Train Loss: [2.448], Accuracy: [0.179]
2023-10-30 13:42:29,125 - INFO - Epoch: [ 11/ 30], Average Train Loss: [2.307], Accuracy: [0.177]
2023-10-30 14:06:45,932 - INFO - Epoch: [ 12/ 30], Average Train Loss: [2.216], Accuracy: [0.173]
2023-10-30 14:31:03,348 - INFO - Epoch: [ 13/ 30], Average Train Loss: [2.089], Accuracy: [0.175]
2023-10-30 14:55:19,625 - INFO - Epoch: [ 14/ 30], Average Train Loss: [1.989], Accuracy: [0.172]
2023-10-30 15:19:37,296 - INFO - Epoch: [ 15/ 30], Average Train Loss: [1.911], Accuracy: [0.177]
2023-10-30 15:43:55,671 - INFO - Epoch: [ 16/ 30], Average Train Loss: [1.823], Accuracy: [0.169]
2023-10-30 16:08:14,226 - INFO - Epoch: [ 17/ 30], Average Train Loss: [1.759], Accuracy: [0.170]
2023-10-30 16:32:31,338 - INFO - Epoch: [ 18/ 30], Average Train Loss: [1.703], Accuracy: [0.168]
2023-10-30 16:56:48,930 - INFO - Epoch: [ 19/ 30], Average Train Loss: [1.685], Accuracy: [0.172]
2023-10-30 17:21:07,735 - INFO - Epoch: [ 20/ 30], Average Train Loss: [1.597], Accuracy: [0.169]
2023-10-30 17:45:25,352 - INFO - Epoch: [ 21/ 30], Average Train Loss: [1.509], Accuracy: [0.170]
2023-10-30 18:09:42,220 - INFO - Epoch: [ 22/ 30], Average Train Loss: [1.469], Accuracy: [0.168]
2023-10-30 18:33:58,895 - INFO - Epoch: [ 23/ 30], Average Train Loss: [1.464], Accuracy: [0.169]
2023-10-30 18:58:16,071 - INFO - Epoch: [ 24/ 30], Average Train Loss: [1.437], Accuracy: [0.167]
2023-10-30 19:22:32,975 - INFO - Epoch: [ 25/ 30], Average Train Loss: [1.416], Accuracy: [0.165]
2023-10-30 19:46:50,502 - INFO - Epoch: [ 26/ 30], Average Train Loss: [1.375], Accuracy: [0.166]
2023-10-30 20:11:08,663 - INFO - Epoch: [ 27/ 30], Average Train Loss: [1.384], Accuracy: [0.169]
2023-10-30 20:35:26,514 - INFO - Epoch: [ 28/ 30], Average Train Loss: [1.344], Accuracy: [0.168]
2023-10-30 20:59:44,691 - INFO - Epoch: [ 29/ 30], Average Train Loss: [1.296], Accuracy: [0.166]
2023-10-30 21:24:01,398 - INFO - Epoch: [ 30/ 30], Average Train Loss: [1.288], Accuracy: [0.169]
2023-10-30 21:24:01,398 - INFO - Trained totally 30 epochs, average train time is 1381.533s, average eval time is 77.167s
2023-10-30 21:24:01,398 - INFO - Loaded model at /home/mindspore/yxx/m-libcity/M_libcity/cache/66705/model_cache/DeepMove_foursquare_nyc.ckpt
2023-10-30 21:25:16,543 - INFO - test result:
2023-10-30 21:25:16,543 - INFO - {'Precision@1': 0.16996951219512196, 'Recall@1': 0.16996951219512196}
